#audit.yaml
#https://cloud.google.com/anthos-config-management/docs/how-to/auditing-constraints
#To see violations of a given constraint-
#kubectl get K8sPSPAllowedUsers user-must-be-3333 -o yaml

#To get all Policy Controller logs, run the following command:
#kubectl logs -n gatekeeper-system -l gatekeeper.sh/system=yes
#You can view audit reports in your logs -
#The audit results have "process":"audit" in the log lines

#There are two enforcement actions: deny and dryrun.
#deny is the default enforcement action. It's automatically enabled, even if you don't add an enforcement action in your constraint.

apiVersion: constraints.gatekeeper.sh/v1beta1
kind: K8sPSPAllowedUsers
metadata:
  name: user-must-be-3333
spec:
  enforcementAction: dryrun
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Pod"]
  parameters:
    runAsUser:
      rule: MustRunAs
      ranges:
        - min: 3333
          max: 3333
